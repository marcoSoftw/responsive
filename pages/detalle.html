<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Principal</title>

   <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <script src="../js/index.js"></script>
	<link rel="stylesheet" href="../css/bootstrap.min.css">
    <link rel="stylesheet" href="../css/estilos.css">
    <script language="javascript" src="../js/jquery-3.2.1.min.js"></script>

</head>
<body onload="leer();">

  <div class="container">
    	<div class="row">
    		<div class="col-sm-12">
    			 <div class= "encabezado">
						<div class="titulo">
							DETALLES
						</div>
						<div class="logo">
							<a title="" href="../index.html" ><img class="img-fluid height: auto rounded float-left imgCabecera" src="../img/logo.png" alt="" /></a>
						</div>

						<div class="cuenta">
							<a href="../pages/cuenta.html" ><img class="img-fluid height: auto rounded float-right imgCuenta" 
							src="../img/user5.png" alt="" /></a>
						</div>

						<div class="espaciado">
							<a id="detalle2"></a>
						</div>
        		</div>
    		</div>
    	</div>


		<div class="row">
    			<div class="col-sm-4 col-xs-12">  
				  		<div id="menu">
                            	<ul>
                                     <li class="nivel1"><a href="producto.html" >Productos</a></li>
                                     <li class="nivel1"><a href="informatica.html" >Informática</a></li>
                                     <li class="nivel1"><a href="electro.html" >Electrodomésticos</a></li>
                                     <li  class="nivel1"><a href="celular.html" >Celulares</a></li>
                            	</ul>
                          </div>
   				</div>


	
    
    <div class="col-sm-8 col-xs-12" >
				<div class="producto">
						<div class="row border border-dark">
								<div class="img-contenido-detalle col-md-5 .col-xs-12 ">
									<img class="img-contenido-detalle" src="" id="imagen">
								</div>
								<div class="detalle-producto border border-dark col-md-6 .col-xs-12">
									 <p class="detalle-marca">  MARCA
										<br>
										<a id="marca"></a>

										</p>
										
										 <p class="detalle-detalle">  DETALLE
										<br>
										<a id="detalle"></a>

										</p>
										
										<p class="detalle-disponibilidad">  DISPONIBILIDAD
										<br>
										<a id="disponibilidad"></a>

										</p>
										
										<p class="detalle-precio">  PRECIO
										<br>
										<a id="precio"></a>

										</p>

								
						
								
						   			
						</div>
					
				</div>
								<br>
								<div class="rowX">
							   			<div class="botones">
													  <a  onclick="detalleModal();" class="boton" href="#agregar" >Agregar</a>
													  <a class="boton2" href="javascript:history.back();" target="_blank">Atras</a>



							   			</div>
							   
							   	</div>
				</div>

			</div>
        </div>

    </div>
     <br>
<br>
<br>
<br>
<br>
<br>
<br>

		<div class="row">
			 <footer class="footer col-sm-12 col-xs-12">
						Marcos Acosta

						<br>
						Rodrigo González
						<br>

						Universidad Nacional de Canindeyú
						<br>
				</footer>
		</div>

</body>

        <script type="text/javascript">

          var clave = localStorage.getItem("clave");
          var tipo = localStorage.getItem("tipo");



         console.log("Id del producto selecccionado " + clave);
         console.log("TIPO " + tipo)

             if ( tipo == 1) {


             var leer = function() {


                $.getJSON("../json/informatica.json", function (data) {
               var img, marca, detalle, disponibilidad, precio;


               img = data.arrayInformatica[clave].img;
                 console.log(img);

               marca = data.arrayInformatica[clave].marca;
                 console.log(marca);

               detalle= data.arrayInformatica[clave].detalle;
                 console.log(detalle);
              detalle2 = data.arrayInformatica[clave].detalle;
                console.log(detalle2);

               disponibilidad=data.arrayInformatica[clave].disponibilidad;
                 console.log(disponibilidad);

                disponibilidad2=data.arrayInformatica[clave].disponibilidad;


               precio= data.arrayInformatica[clave].precio;
                 console.log(precio);
                precio2= data.arrayInformatica[clave].precio;



              document.getElementById('imagen').src= "../img/info/"+img;
              document.getElementById('marca').innerHTML = marca;
              document.getElementById('detalle').innerHTML = detalle;
              document.getElementById('disponibilidad').innerHTML = disponibilidad;
              document.getElementById('precio').innerHTML = precio;

              document.getElementById('detalle2').innerHTML = detalle;


             });



        }

        }
            if ( tipo == 2) {

                console.log("Entro en tipo celular " + tipo)
               var leer = function() {


                $.getJSON("../json/celular.json", function (data) {
               var img, marca, detalle, disponibilidad, precio;


              img = data.arrayCelular[clave].img;
                 console.log(img);

               marca = data.arrayCelular[clave].marca;
                 console.log(marca);

               detalle= data.arrayCelular[clave].detalle;
                 console.log(detalle);
              detalle2 = data.arrayCelular[clave].detalle;
                console.log(detalle2);

               disponibilidad=data.arrayCelular[clave].disponibilidad;
                 console.log(disponibilidad);

                disponibilidad2=data.arrayCelular[clave].disponibilidad;


               precio= data.arrayCelular[clave].precio;
                 console.log(precio);

               precio2 = data.arrayCelular[clave].precio;



              document.getElementById('imagen').src= "../img/cel/"+img;
              document.getElementById('marca').innerHTML = marca;
              document.getElementById('detalle').innerHTML = detalle;
              document.getElementById('disponibilidad').innerHTML = disponibilidad;
              document.getElementById('precio').innerHTML = precio ;

              document.getElementById('detalle2').innerHTML = detalle;



             });

        }
    }
           if ( tipo == 3) {

               console.log("Entro en tipo electo " + tipo)

                var leer = function() {


                $.getJSON("../json/electro.json", function (data) {
               var img, marca, detalle, disponibilidad, precio;


               img = data.arrayElectro[clave].img;
                 console.log(img);

               marca = data.arrayElectro[clave].marca;
                 console.log(marca);

               detalle= data.arrayElectro[clave].detalle;
                 console.log(detalle);
                detalle2 = data.arrayElectro[clave].detalle;
               disponibilidad=data.arrayElectro[clave].disponibilidad;
                 console.log(disponibilidad);
                disponibilidad2 = data.arrayElectro[clave].disponibilidad;
               precio= data.arrayElectro[clave].precio;
                 console.log(precio);
               precio2= data.arrayElectro[clave].precio;


              document.getElementById('imagen').src= "../img/electro/"+img;
              document.getElementById('marca').innerHTML = marca;
              document.getElementById('detalle').innerHTML = detalle;
              document.getElementById('disponibilidad').innerHTML = disponibilidad;
              document.getElementById('precio').innerHTML = precio;

              document.getElementById('detalle2').innerHTML = detalle;



             });

            }
        }




        </script>


<div id="agregar">
    <div class="popup-contenedor2">
     

       <form >    
                 
                <div>
					 <h3>Cantidad</h3>
					 <input type="number" min="1" max="100" id="cantidad" autofocus onChange="calculo(this.value, precio2);">
					 
					 <br>
					 <br>
					 <h3>Total</h3>
					<input type="text" id="totalText" readonly>
				</div>
       </form>
                 <br>

             <div >

             <input onclick="agregarLista(), $('#agregar, .window').hide()" visibility= "hidden" class="boton" type="submit" value="Confirmar"  >
            
             </div>
             <br>

       <a class="popup-cerrar" href="#">X</a>
    </div>
    
    </div>
    
    

    <script>

         var list=Array();


        function agregarLista(){

             var saldo=0;
             var saldoActual=0;
             var saldoCargar=0;


             saldoActual  = sessionStorage.getItem("saldo");
             saldoCargar = document.getElementById("totalText").value;

            if(!saldoActual){

                saldoActual=5000;
              }

                if (saldoActual>=1){

                    saldoActual = (parseInt(saldoActual) - parseInt(saldoCargar));


                    if(saldoActual>=1){

                         console.log("El saldo actual es " + saldoActual);

                    var saldo = sessionStorage.setItem("saldo", saldoActual);

                    var  totalDisponible=0;
                    var valorDescripcion = detalle2;
                    var valorPrecioUnitario = precio2;
                    var valorCantidad = document.getElementById("cantidad").value;
                    var valorSubtotal = document.getElementById("totalText").value;


            total();

            function total () {

                 async: true;

                  var  totalActual = sessionStorage.getItem("total");

				if(valorSubtotal==0){
					console.log("Subtotal es  " + valorSubtotal);
					window.alert("No se ingresaron datos validos");
					window.location="responsive/pages/detalle.html";
				}else{
			
                	if(!totalActual){

                    totalActual=0;
                }
				
				
                 console.log("El total actual es " + totalActual);

                 var totalNuevo  = (parseInt(totalActual) + parseInt(valorSubtotal));

                 console.log("El total es " + totalNuevo);

                 var total = sessionStorage.setItem("total", totalNuevo);

                 var lista = JSON.parse(sessionStorage.getItem("productos"));

                if(lista==null) lista = [];

                var producto = {"descripcion" : detalle2,
                           "precio" : precio2,
                            "cantidad" : document.getElementById("cantidad").value,
                            "subtotal" : document.getElementById("totalText").value,
                           };

                lista.push(producto);
                sessionStorage.setItem("productos", JSON.stringify(lista));
                console.log(lista)

				mensaje();

				function mensaje(){

								window.alert("Se agregó el producto al carrito!");
								window.location="responsive/pages/cuenta.html";

							}

                    	}
					}

                 }
                    else{

                        alert("No se puede agregar el producto, consultar la disponibilidad de saldo en la cuenta!");
						window.location="responsive/pages/detalle.html";
                    }

                }
        }

                </script>

    <script>

      function calculo(cantidad,precio2){

            console.log(precio2);

            console.log(cantidad);


	       total = precio2*cantidad;

            totalText.value = total;


}


</script>

</html>
